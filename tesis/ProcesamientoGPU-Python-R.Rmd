```{r setup}
#install.packages("reticulate")

library(reticulate)
env_path <- "$HOME/home/wmalex/Documentos/Tesis/tesis/GPU-Project"
virtualenv_create(envname = env_path)
py_install("seaborn", envname = env_path)
use_virtualenv(env_path)

```

```{r}
library(reticulate)
py_install("numba")
py_install("jit")
py_install("joblib")
py_install("pandas")
py_install("requests")
py_install("torch")
py_install("rpy2")

#py_install("cuda")
py_config()
```

```{python setup}
import numpy as np
import torch
import torch.nn as nn
import rpy2
from rpy2 import robjects
from numba import jit, cuda

```

```{python}
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print(torch.cuda.is_available())
```

```{python}

meta_dataframe = r.metadata_MGYS00005592
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print(torch.cuda.is_available())

```

```{python}

#r.assign('meta_dataframe', meta_dataframe)
# Ejecutar cÃ³digo R
torch.tensor(robjects.r('''
process_metadata()
''')).to(device) 
```
