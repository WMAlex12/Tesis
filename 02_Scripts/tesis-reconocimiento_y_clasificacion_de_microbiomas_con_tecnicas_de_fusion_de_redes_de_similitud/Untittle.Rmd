```{r setup} 
library(reticulate)
virtualenv_create("fmri-proj")
py_install("seaborn", envname = "fmri-proj")
use_virtualenv("fmri-proj")
```

```{python setup}
import numpy as np
import torch
import torch.nn as nn
from numba import jit, cuda
```

```{r}
library(reticulate)
py_config()
py_install("torch")
py_install("numba")
py_install("jit")
py_install("cuda")
```

```{python}
device = torch.device('cuda' if torch.cuda.is_available() else 'cpu')
print(torch.cuda.is_available())
```


```{r}

library(reticulate)

# Usa el entorno virtual correcto
use_virtualenv("fmri-proj")

# Ejecuta el código Python para instalar la versión específica de numpy
py_run_string("
import subprocess
subprocess.check_call(['pip', 'install', 'numpy==2.0.2'])
")

```

